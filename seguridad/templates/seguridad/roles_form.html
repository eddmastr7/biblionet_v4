{% load static %}
<!doctype html><html lang="es"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>{% if rol %}Editar rol{% else %}Nuevo rol{% endif %}</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head><body class="p-4">
  <div class="d-flex justify-content-between mb-3">
    <h3>{% if rol %}Editar rol{% else %}Nuevo rol{% endif %}</h3>
    <a href="{% url 'roles_list' %}" class="btn btn-outline-secondary">Volver</a>
  </div>

  {% if error %}<div class="alert alert-danger">{{ error }}</div>{% endif %}

  <form method="post">{% csrf_token %}
    <div class="mb-3">
      <label class="form-label">Nombre del rol</label>
      <input class="form-control" name="nombre" value="{{ rol.nombre|default:'' }}" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Descripción</label>
      <input class="form-control" name="descripcion" value="{{ rol.descripcion|default:'' }}">
    </div>

    <div class="mb-3">
      <label class="form-label">Permisos</label>
      <div class="row">
        {% for p in permisos %}
          <div class="col-md-4">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="permisos" id="perm{{ p.id }}" value="{{ p.id }}"
                     {% if p.id in selected %}checked{% endif %}>
              <label class="form-check-label" for="perm{{ p.id }}">
                <strong>{{ p.modulo }}</strong> — {{ p.accion }}<br>
                <small class="text-muted">{{ p.descripcion }}</small>
              </label>
            </div>
          </div>
        {% empty %}
          <p class="text-muted">No hay permisos definidos.</p>
        {% endfor %}
      </div>
    </div>

    <div class="text-end">
      <button type="submit" class="btn btn-primary">Guardar</button>
    </div>
  </form>
</body></html>
